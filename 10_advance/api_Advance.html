<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API With Ajax</title>
</head>

<body style="background-color: #212121; color: #fff;">

    | Value | State | Meaning |
    | ----- | ------------------ | -------------------------------------------------------- |
    | **0** | `UNSENT` | Request object created but not opened yet. |
    | **1** | `OPENED` | `open()` has been called, but request not sent. |
    | **2** | `HEADERS_RECEIVED` | `send()` has been called, server responded with headers. |
    | **3** | `LOADING` | Response body is being received (data is downloading). |
    | **4** | `DONE` | Request is finished, response is ready. |
    <div class="main">
        <h1>Name: </h1>
        <img src="" alt="Profile">
        <h1>followers</h1>
        <button id="btn">Show data</button>
    </div>
</body>
<script>
    // const requestUrl  = 'https://api.github.com/users/hiteshchoudhary';

    // // ðŸ‘‰ This code is creating a new XMLHttpRequest object
    // const xhr = new XMLHttpRequest();

    // // ðŸ‘‰ This code is preparing the request (GET request to the GitHub API URL)
    // // open() just sets up the call, it does not send yet
    // xhr.open('GET', requestUrl);

    // // ðŸ‘‰ This code is tracking the progress of the request
    // // onreadystatechange runs every time readyState changes
    // xhr.onreadystatechange = function(){    

    //     // ðŸ‘‰ This code is showing the current state (1 â†’ 2 â†’ 3 â†’ 4)
    //     console.log("Current readyState:", xhr.readyState);  

    //     // ðŸ‘‰ This code checks if request is DONE (4 = finished, response ready)
    //     if (xhr.readyState === 4) {

    //         // ðŸ‘‰ This code converts the string response (JSON text) into a real object
    //         const data = JSON.parse(this.responseText);  

    //         // this.responseText === xhr.responseText
    //         // We use "this" because it's the current request context

    //         // ðŸ‘‰ This code checks the type of data after parsing (it will be an object now)
    //         console.log("Type of data after JSON.parse:", typeof data); // "object"

    //         console.log("Followers:", data.followers); 
    //     }
    // }

    // ðŸ‘‰ This code is actually sending the request
    // xhr.send();


        // task => show the data after click btn 

        const requestUrl = "https://api.github.com/users/hiteshchoudhary";
        let userData;
        const xhr = new XMLHttpRequest();
        xhr.open('GET', requestUrl);
        // console.log(xhr.readyState);  // not state in 0(UNSENT)

        xhr.onreadystatechange = function(){
            console.log('Now state is :', xhr.readyState); // check the state 
            if(xhr.readyState === 4 && xhr.status === 200 ){
                 userData = JSON.parse(this.responseText);        
                //  console.log(typeof userData); //without use JSON.parse data comes in string
                console.log(this.responseText);
                console.log('UserName: ',userData.name);
                console.log('UserBio: ',userData.bio);

        const pera = document.createElement('p')
                pera.innerHTML = `
               <h2>Name : </h2> ${userData.name}  <br>
               <h2>Bio : </h2> ${userData.bio} <br>
               <h2>Follower : </h2> ${userData.followers}
                `
                document.body.appendChild(pera)
            }
            
        }
        
        xhr.send()


</script>


</html>